---
layout: post
title:  Ubuntu常用命令
---
<!-- ----------------------------------开始--------用表格分割屏幕 -->
<table border="0" width="100%" cellpadding="10">
<tr>
<!-- ------------------------------开始------第一列 -->
<td width="50%" valign="top">
<center>
<b>同步时间</b>
<textarea cols="50" rows="2">sudo ntpdate-debian && sudo hwclock -w</textarea>

<b>全部复制</b>
<textarea cols="50" rows="2">cp -r * .[!.]*</textarea>

<b>清除缩略图</b>
<textarea cols="50" rows="2">rm ~/.thumbnails/normal/*</textarea>

<b>批量改变图片为300x200</b>
<textarea cols="50" rows="2">
sudo apt-get install imagemagick
for i in *.jpg; do convert -scale 300x200 $i $i; done
</textarea>
</center>
</td>
<!-- ------------------------------结束------第一列 -->
<!-- ------------------------------开始------第二列 -->
<td width="50%" valign="top">
<center>
<b>备份软件包</b>
<textarea cols="50" rows="2">
tar cizvf deb.tgz /var/cache/apt/archives --exclude=/var/cache/apt/archives/partial/* --exclude=/var/cache/apt/archives/lock
</textarea>

<b>还原软件包</b>
<textarea cols="50" rows="2">
sudo apt-get update && sudo tar xzvf backup.tar.gz -C /
</textarea>

<b>单分区备份系统</b>
<textarea cols="50" rows="2">sudo tar -Ppzcvf sys.back.tgz --exclude=/proc/* --exclude=/sys/* --exclude=/tmp/* --exclude=/media/* --exclude=/mnt/* --exclude=/lost+found --exclude=/sys.back.tgz /</textarea>

<b>还原到单分区U盘，假设sdb1</b>
<textarea cols="50" rows="2">
sudo mount /dev/sdb1 /mnt
sudo tar -pzxvf sys.back.tgz -C /mnt
sudo grub-install --root-directory=/mnt /dev/sdb
sudo blkid========================>查看sdb1的UUID
sudo nano /mnt/etc/fstab============>替换成sdb1的UUID
sudo nano /mnt/boot/grub/grub.cfg=====>搜索"set=root"，替换成sdb1的UUID;搜索"set root="，改成'(hd0,1)'
</textarea>

<b>备份MBR</b>
<textarea cols="50" rows="2">
dd if=/dev/sda of=/backup/mbr.img bs=512 count=1
</textarea>

<b>还原MBR</b>
<textarea cols="50" rows="2">
dd if=/backup/mbr.img of=/dev/sda bs=446 count=1
</textarea>

<b>还原分区表,跳过主引导记录</b>
<textarea cols="50" rows="2">
dd if=/backup/mbr.img of=/dev/sda bs=1 count=64 skip=446 seek=446
</textarea>

<b>查看分区1</b>
<textarea cols="50" rows="2">
sudo fdisk -l
</textarea>

<b>查看分区2</b>
<textarea cols="50" rows="2">
sudo parted /dev/sda print
</textarea>

</center>
</td>
<!-- ------------------------------结束------第二列 -->
</tr>
</table>
<!-- ----------------------------------结束--------用表格分割屏幕 -->
