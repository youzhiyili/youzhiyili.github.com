http://youzhiyili.github.com/2012/12/27/swap.html